- alias: Presence - Turn on away mode
  trigger:
  - platform: state
    entity_id: group.personen
    to: not_home
  action:
  - service: input_boolean.turn_on
    data:
      entity_id: input_boolean.homemode_away
  id: b4f7637082684d3eb88f91fec42387db
- alias: Presence - Turn on home mode
  trigger:
  - platform: state
    entity_id: group.personen
    to: home
  action:
  - service: input_boolean.turn_on
    data:
      entity_id: input_boolean.homemode_home
  id: 18295730540f4dcdaf353988dba56693
- alias: Homemode - To home at day time
  trigger:
  - platform: state
    entity_id: input_boolean.homemode_home
    to: 'on'
  condition:
    condition: and
    conditions:
    - condition: state
      entity_id: input_boolean.homemode_guest
      state: 'off'
    - condition: sun
      before: sunset
  action:
  - service: input_boolean.turn_off
    data:
      entity_id: input_boolean.homemode_away, input_boolean.homemode_vacation
  - service: climate.set_away_mode
    data:
      entity_id: climate.thermostaat
      away_mode: 'off'
  - service: climate.set_temperature
    data:
      entity_id: climate.gang
      temperature: 16
  - service: notify.pushover
    data:
      message: Welkom thuis!
      title: Homemode - Overdag
  id: e1ff628528f342abbe268a44c3608dd0
- alias: Homemode - To home at dark
  trigger:
  - platform: state
    entity_id: input_boolean.homemode_home
    to: 'on'
  condition:
    condition: and
    conditions:
    - condition: state
      entity_id: input_boolean.homemode_guest
      state: 'off'
    - condition: sun
      after: sunset
  action:
  - service: input_boolean.turn_off
    data:
      entity_id: input_boolean.homemode_away, input_boolean.homemode_vacation
  - service: hue.hue_activate_scene
    data:
      group_name: Woonkamer
      scene_name: Sfeerverlichting
  - service: hue.hue_activate_scene
    data:
      group_name: Keuken
      scene_name: Normaal
  - service: switch.turn_on
    entity_id:
    - switch.kerstverlichting_buiten
  - service: climate.set_away_mode
    data:
      entity_id: climate.thermostaat
      away_mode: 'off'
  - service: climate.set_temperature
    data:
      entity_id: climate.gang
      temperature: 16
  - service: notify.pushover
    data:
      message: Welkom thuis! Het licht is ingeschakeld!
      title: Homemode (Avond)
  id: b3681deb2bb64ba7862e7a38ede5f6c2
- alias: Homemode - To away at daytime
  trigger:
  - platform: state
    entity_id: input_boolean.homemode_away
    to: 'on'
  condition:
    condition: and
    conditions:
    - condition: state
      entity_id: input_boolean.homemode_guest
      state: 'off'
    - condition: sun
      before: sunset
  action:
  - service: input_boolean.turn_off
    data:
      entity_id: input_boolean.homemode_home
  - service: homeassistant.turn_off
    entity_id:
    - group.all_lights
    - switch.keukenkachel
  - service: climate.set_away_mode
    data:
      entity_id: climate.thermostaat
      away_mode: 'on'
  - service: climate.set_temperature
    data:
      entity_id: climate.gang
      temperature: 7
  - service: media_player.media_pause
    data_template:
      entity_id:
      - media_player.woonkamer
      - media_player.badkamer
      - media_player.keuken
      - media_player.tvkamer
  - service: notify.martien
    data:
      message: Away mode is geactiveerd, tot ziens!
      title: Away Mode (Overdag)
  id: 17bc35c4092640d38ff785605b85bb2c
- alias: Homemode - To away at dark
  trigger:
  - platform: state
    entity_id: input_boolean.homemode_away
    to: 'on'
  condition:
    condition: and
    conditions:
    - condition: state
      entity_id: input_boolean.homemode_guest
      state: 'off'
    - condition: sun
      after: sunset
  action:
  - service: input_boolean.turn_off
    data:
      entity_id: input_boolean.homemode_home
  - service: homeassistant.turn_off
    entity_id:
    - switch.keukenkachel
  - service: climate.set_away_mode
    data:
      entity_id: climate.thermostaat
      away_mode: 'on'
  - service: climate.set_temperature
    data:
      entity_id: climate.gang
      temperature: 7
  - service: hue.hue_activate_scene
    data:
      group_name: Woonkamer
      scene_name: Sfeerverlichting
  - service: hue.hue_activate_scene
    data:
      group_name: Keuken
      scene_name: Sfeerverlichting
  - service: media_player.media_pause
    data_template:
      entity_id:
      - media_player.woonkamer
      - media_player.badkamer
      - media_player.keuken
      - media_player.tvkamer
  - service: notify.martien
    data:
      message: Away mode is geactiveerd, tot ziens!
      title: Away Mode (Avond)
  id: 03476c7738d2433cb47dbed5caa440b3
- alias: Homemode - Nachtmode aan
  trigger:
  - platform: state
    entity_id: input_boolean.homemode_night
    to: 'on'
  action:
  - service: input_boolean.turn_off
    data:
      entity_id: input_boolean.homemode_bedtime
  - service: homeassistant.turn_off
    entity_id:
    - group.all_lights
    - switch.ganglicht
    - switch.keukenkachel
    - switch.kerstverlichting_buiten
    - input_boolean.homemode_goodmorning
  - service: climate.set_temperature
    data:
      entity_id: climate.thermostaat
      temperature: 14
  - service: climate.set_temperature
    data:
      entity_id: climate.gang
      temperature: 7
  - service: media_player.media_pause
    data_template:
      entity_id:
      - media_player.woonkamer
      - media_player.badkamer
      - media_player.keuken
      - media_player.tvkamer
  - service: media_player.volume_set
    data_template:
      volume_level: '0.02'
      entity_id:
      - media_player.woonkamer
      - media_player.badkamer
      - media_player.keuken
      - media_player.tvkamer
  - service: notify.martien
    data:
      message: Slaap lekker!
      title: Nachtmode
  id: 98f69e468cd24943a8c63eff454c2d6c
- alias: Homemode - Bedtijd aan
  trigger:
  - platform: state
    entity_id: input_boolean.homemode_bedtime
    to: 'on'
  action:
  - service: hue.hue_activate_scene
    data:
      group_name: Slaapkamer
      scene_name: Ontspannen
  - service: hue.hue_activate_scene
    data:
      group_name: Overloop
      scene_name: Gedimd
  - service: homeassistant.turn_off
    entity_id:
    - group.woonkamer_verlichting
    - group.keuken_verlichting
    - group.badkamer_spots
    - switch.ganglicht
    - switch.keukenkachel
    - switch.kerstverlichting_buiten
    - input_boolean.homemode_goodmorning
    - input_boolean.homemode_sfeer
  - service: climate.set_temperature
    data:
      entity_id: climate.thermostaat
      temperature: 14
  - service: climate.set_temperature
    data:
      entity_id: climate.gang
      temperature: 7
  - service: media_player.media_pause
    data_template:
      entity_id:
      - media_player.woonkamer
      - media_player.badkamer
      - media_player.keuken
      - media_player.tvkamer
  - service: media_player.volume_set
    data_template:
      volume_level: '0.02'
      entity_id:
      - media_player.woonkamer
      - media_player.badkamer
      - media_player.keuken
      - media_player.tvkamer
  - service: notify.martien
    data:
      message: Het huis is klaar gemaakt voor bedtijd!
      title: Bedtijd
  id: 007326c9e8cc487aa05f39bffff8c218
- alias: Homemode - Opstaan aan
  trigger:
  - platform: state
    entity_id: input_boolean.homemode_goodmorning
    to: 'on'
  action:
  - service: homeassistant.turn_off
    entity_id:
    - input_boolean.homemode_night
    - input_boolean.homemode_bedtime
    - input_boolean.homemode_sfeer
  - service: hue.hue_activate_scene
    data:
      group_name: Woonkamer
      scene_name: Sfeerverlichting
  - service: hue.hue_activate_scene
    data:
      group_name: Keuken
      scene_name: Sfeerverlichting
  - service: climate.set_temperature
    data:
      entity_id: climate.thermostaat
      temperature: 17
  - service: climate.set_temperature
    data:
      entity_id: climate.gang
      temperature: 17
  - service: media_player.volume_set
    data_template:
      volume_level: '0.02'
      entity_id:
      - media_player.woonkamer
      - media_player.badkamer
      - media_player.keuken
      - media_player.tvkamer
  - service: notify.martien
    data:
      message: Goedemorgen! Tijd voor een nieuwe dag!
      title: Opstaan
  id: 800db39197624b95aee48fd1d95dae55
- alias: Homemode - Sfeer aan
  trigger:
  - platform: state
    entity_id: input_boolean.homemode_sfeer
    to: 'on'
  action:
  - service: homeassistant.turn_off
    entity_id:
    - input_boolean.homemode_helder
    - switch.ganglicht
    - light.badkamer_spots
  - service: hue.hue_activate_scene
    data:
      group_name: Woonkamer
      scene_name: Sfeerverlichting
  - service: hue.hue_activate_scene
    data:
      group_name: Keuken
      scene_name: Sfeerverlichting
  id: e3a4450aa26c415f869c316e9a05079c
- alias: Homemode - Helder aan
  trigger:
  - platform: state
    entity_id: input_boolean.homemode_helder
    to: 'on'
  action:
  - service: homeassistant.turn_off
    entity_id:
    - input_boolean.homemode_sfeer
    - input_boolean.homemode_goodmorning
  - service: hue.hue_activate_scene
    data:
      group_name: Woonkamer
      scene_name: Helder
  - service: hue.hue_activate_scene
    data:
      group_name: Keuken
      scene_name: Helder
  - service: hue.hue_activate_scene
  id: 21c4b216c57e42d18a5bab638d56b57a
- alias: Homemode - Reset input_boolean.homemode_goodmorning na 60 min.
  trigger:
  - platform: state
    entity_id: input_boolean.homemode_goodmorning
    to: 'on'
    for:
      minutes: 60
  action:
  - service: homeassistant.turn_off
    entity_id:
    - input_boolean.homemode_goodmorning
  id: 92d8dd2596834839b4668c3e45157256
- alias: Alarm - Arm Away from HA / Homekit
  trigger:
  - platform: state
    entity_id: alarm_control_panel.alarm
    to: armed_away
  condition:
    condition: state
    entity_id: input_boolean.alarm_armfromkeypad
    state: 'off'
  action:
  - service: homeassistant.turn_off
    data:
      entity_id: switch.alarm_panel_arm
  - service: notify.pushover
    data_template:
      message: Arm alarm in away mode from HA / Homekit...
      title: Alarm Armed Away
  - service: input_boolean.turn_on
    entity_id: input_boolean.homemode_away
  - service: homeassistant.turn_on
    data:
      entity_id: switch.looppoort_deurbel_relay_1
  id: 1848784a892d42f6b8d6519a429613d1
- alias: Alarm - Arm Home from HA / Homekit
  trigger:
  - platform: state
    entity_id: alarm_control_panel.alarm
    to: armed_home
  condition:
    condition: state
    entity_id: input_boolean.alarm_armfromkeypad
    state: 'off'
  action:
  - service: homeassistant.turn_off
    data:
      entity_id: switch.alarm_panel_arm_home
  - service: notify.pushover
    data_template:
      message: Arm alarm in home mode from HA / Homekit...
      title: Alarm Armed Home
  id: 1662cff71fcb448ea9b2e059e084abbf
- alias: Alarm - Arm Night from HA / Homekit
  trigger:
  - platform: state
    entity_id: alarm_control_panel.alarm
    to: armed_home
  condition:
    condition: state
    entity_id: input_boolean.alarm_armfromkeypad
    state: 'off'
  action:
  - service: homeassistant.turn_off
    data:
      entity_id: switch.alarm_panel_arm_home
  - service: notify.pushover
    data_template:
      message: Arm alarm in home mode from HA / Homekit...
      title: Alarm Armed Home
  id: 9c0ecb7091cf48b68469021950980d59
- alias: Alarm - Disarm Alarm HA / Homekit
  trigger:
  - platform: state
    entity_id: alarm_control_panel.alarm
    to: disarmed
  condition:
    condition: state
    entity_id: input_boolean.alarm_disarmfromkeypad
    state: 'off'
  action:
  - service: homeassistant.turn_on
    data:
      entity_id: switch.alarm_panel_disarm
  - service: notify.pushover
    data_template:
      message: Disarm Alarm from HA / Homekit...
      title: Disarm Alarm
  - service: input_boolean.turn_on
    entity_id: input_boolean.homemode_home
  id: 676617aa3dd24db692561d2c65e87441
- alias: Alarm - Arm Away from Keypad
  trigger:
  - platform: event
    event_type: button_pressed
    event_data:
      entity_id: switch.alarm_panel_arm
  action:
  - service: input_boolean.turn_on
    entity_id: input_boolean.alarm_armfromkeypad
  - service: alarm_control_panel.alarm_arm_away
    data:
      entity_id: alarm_control_panel.alarm
      code: 8284
  - service: notify.pushover
    data_template:
      message: Arm alarm in away mode signal received from keypad
      title: Alarm Armed Away
  - service: input_boolean.turn_on
    entity_id: input_boolean.homemode_away
  - service: homeassistant.turn_on
    data:
      entity_id: switch.looppoort_deurbel_relay_1
  id: dd6bcc0623084424a77538882a84cd91
- alias: Alarm - Arm Home from Keypad
  trigger:
  - platform: event
    event_type: button_pressed
    event_data:
      entity_id: switch.alarm_panel_arm_home
  action:
  - service: input_boolean.turn_on
    entity_id: input_boolean.alarm_armfromkeypad
  - service: alarm_control_panel.alarm_arm_home
    data:
      entity_id: alarm_control_panel.alarm
      code: 8284
  - service: notify.pushover
    data_template:
      message: Arm alarm in home mode signal received from keypad
      title: Alarm Arm Home
  id: 4cd892d87a654e26b00ae34133521b1e
- alias: Alarm - Disarm from Keypad
  trigger:
  - platform: event
    event_type: button_pressed
    event_data:
      entity_id: switch.alarm_panel_disarm
  action:
  - service: input_boolean.turn_on
    entity_id: input_boolean.alarm_disarmfromkeypad
  - service: alarm_control_panel.alarm_disarm
    data:
      entity_id: alarm_control_panel.alarm
      code: 8284
  - service: notify.pushover
    data_template:
      message: Disarm alarm signal received from keypad
      title: Alarm Disarmed
  - service: input_boolean.turn_on
    entity_id: input_boolean.homemode_home
  id: 90ebcccfb39e46cb9f81525a2d0da4d7
- alias: Alarm - Reset Arm and Disarm boolean
  trigger:
  - platform: state
    entity_id: input_boolean.alarm_armfromkeypad
    to: 'on'
    for:
      seconds: 30
  - platform: state
    entity_id: input_boolean.alarm_disarmfromkeypad
    to: 'on'
    for:
      seconds: 30
  action:
  - service: input_boolean.turn_off
    data:
      entity_id:
      - input_boolean.alarm_armfromkeypad
      - input_boolean.alarm_disarmfromkeypad
  id: be665d4624ca43b48050819142608429
- alias: Timer - Set Input_number Values at Midnight
  trigger:
    platform: time
    at: 00:00:00
  action:
  - service: input_number.set_value
    data_template:
      entity_id: input_number.midnight_power_consumption_normal
      value: '{{ states.sensor.power_consumption_normal.state }}'
  - service: input_number.set_value
    data_template:
      entity_id: input_number.midnight_power_consumption_low
      value: '{{ states.sensor.power_consumption_low.state }}'
  - service: input_number.set_value
    data_template:
      entity_id: input_number.midnight_power_production_normal
      value: '{{ states.sensor.power_production_normal.state }}'
  - service: input_number.set_value
    data_template:
      entity_id: input_number.midnight_power_production_low
      value: '{{ states.sensor.power_production_low.state }}'
  - service: input_number.set_value
    data_template:
      entity_id: input_number.midnight_gas_consumption
      value: '{{ states.sensor.gas_consumption.state }}'
  id: ddeb4a8a234d4f0d90cc73c9f24b0f5c
- alias: Timer - Automatisch HA Thema
  trigger:
  - platform: homeassistant
    event: start
  - platform: state
    entity_id: sun.sun
  action:
  - service_template: frontend.set_theme
    data_template:
      name: '{% if states.sun.sun.state == "above_horizon" %} default {% else %} midnight
        {% endif %}

        '
  id: 96bb1502ba734e96a2de9c716cf89f0c
- alias: Timer - Notify Me when its time to leave for Work
  trigger:
  - platform: state
    entity_id: sensor.time_to_leave_for_work
    to: 'True'
    from: 'False'
  condition:
  - condition: state
    entity_id: binary_sensor.workday_sensor
    state: 'on'
  action:
  - service: notify.martien
    data:
      message: Het duurt {{ states.sensor.reistijd_naar_werk.state | int | string
        }} minuten om naar je werk te rijden. Je moet over 10 minuten vertrekken wil
        je om 8:30u aankomen. De snelste route is via {{ states.sensor.reistijd_naar_werk.attributes.route
        }}.
      title: Tijd om te vertrekken
  id: 21e72806d2354e3c817f1e85ac34c0f2
- alias: Timer - Notification - Reistijd naar huis
  trigger:
    platform: time
    at: '17:00:00'
  condition:
  - condition: state
    entity_id: binary_sensor.workday_sensor
    state: 'on'
  action:
  - service: notify.martien
    data:
      message: Het duurt momenteel {{ states.sensor.reistijd_naar_huis.state | int
        | string }} minuten om naar huis te rijden. De snelste route is via {{ states.sensor.reistijd_naar_huis.attributes.route
        }}.
      title: Reistijd naar huis
  id: affda59ba6814429a0f5b3c84b096e13
- alias: Timer - Notification - Energie Rapport
  trigger:
    platform: time
    at: '23:59:50'
  action:
  - service: notify.pushover
    data:
      message: 'Energieverbruik vandaag: {{ states.sensor.net_power_usage_today_total.state
        }} kWh.

        Gasverbruik vandaag: {{ states.sensor.gas_consumption_today.state }} m3.

        '
      title: Energie Rapport
  id: 5254b3b5c5d544d3ab1e9a6bfbff8817
- alias: Timer - Turn off Hyper-V machine at night
  trigger:
    platform: time
    at: 00:00:00
  action:
  - service: switch.turn_off
    entity_id: switch.hyperv_host
  - service: notify.pushover
    data:
      message: Shutting down Hyper-V machine...
      title: Hyper-V
      data:
        url: https://martiendekleijn.duckdns.org:8123/
  id: a6123de07fe24751b832749585be5ad7
- alias: Timer - Turn on Hyper-V machine in the morning on workday
  trigger:
    platform: time
    at: 06:00:00
  condition:
    condition: state
    entity_id: binary_sensor.workday_sensor
    state: 'on'
  action:
  - service: switch.turn_on
    entity_id: switch.hyperv_host
  - service: notify.pushover
    data:
      message: Starting Hyper-V machine...
      title: Hyper-V
      data:
        url: https://martiendekleijn.duckdns.org:8123/
  id: 179b05715b29432eadef85ed4f830828
- alias: Timer - Turn on Hyper-V machine in the morning on non-workday
  trigger:
    platform: time
    at: 08:00:00
  condition:
    condition: state
    entity_id: binary_sensor.workday_sensor
    state: 'off'
  action:
  - service: switch.turn_on
    entity_id: switch.hyperv_host
  - service: notify.pushover
    data:
      message: Starting Hyper-V machine...
      title: Hyper-V
      data:
        url: https://martiendekleijn.duckdns.org:8123/
  id: fa27c7208ed742248c717ff3ff45443f
- alias: Timer - Licht aan wanneer er iemand thuis is
  trigger:
    platform: sun
    event: sunset
    offset: -00:35:00
  condition:
    condition: and
    conditions:
    - condition: state
      entity_id: input_boolean.homemode_home
      state: 'on'
    - condition: state
      entity_id: group.woonkamer_verlichting
      state: 'off'
    - condition: state
      entity_id: group.keuken_verlichting
      state: 'off'
  action:
  - service: hue.hue_activate_scene
    data:
      group_name: Woonkamer
      scene_name: Sfeerverlichting
  - service: hue.hue_activate_scene
    data:
      group_name: Keuken
      scene_name: Ontspannen
  - service: switch.turn_on
    entity_id:
    - switch.kerstverlichting_buiten
  - service: notify.pushover
    data:
      message: Home Assistant heeft het licht ingeschakeld.
      title: Verlichting
  id: 21d020fa9c444fd2be6566b948a85792
- alias: Timer - Licht aan wanneer er niemand thuis is
  trigger:
    platform: sun
    event: sunset
    offset: +00:30:00
  condition:
    condition: and
    conditions:
    - condition: state
      entity_id: input_boolean.homemode_away
      state: 'on'
  action:
  - service: hue.hue_activate_scene
    data:
      group_name: Woonkamer
      scene_name: Sfeerverlichting
  - service: hue.hue_activate_scene
    data:
      group_name: Keuken
      scene_name: Sfeerverlichting
  - service: switch.turn_on
    entity_id:
    - switch.kerstverlichting_buiten
  - service: notify.pushover
    data:
      message: Home Assistant heeft het licht ingeschakeld.
      title: Verlichting
  id: 8014f44508a141f7a0cf48d3f144783e
- alias: Timer - Licht uit om 23:00 when wanneer er niemand thuis is
  trigger:
    platform: time
    at: '23:30:00'
  condition:
    condition: and
    conditions:
    - condition: state
      entity_id: input_boolean.homemode_home
      state: 'off'
    - condition: state
      entity_id: input_boolean.homemode_guest
      state: 'off'
  action:
  - service: homeassistant.turn_off
    entity_id:
    - group.woonkamer_verlichting
    - group.keuken_verlichting
  - service: switch.turn_off
    entity_id:
    - switch.kerstverlichting_buiten
  - service: notify.pushover
    data:
      message: Home Assistant heeft het licht uitgeschakeld.
      title: Verlichting
  id: 861b79722d344410bc7b26bcb8cac987
- alias: Timer - Start HomeKit
  trigger:
  - platform: homeassistant
    event: start
  action:
  - delay: 00:03
  - service: homekit.start
  - service: notify.pushover
    data:
      message: Home Assistant HomeKit service started.
      title: HomeKit Online
      data:
        url: https://martiendekleijn.duckdns.org:8123/
  id: e7ab9f253679477399d9200fed2c4f01
- alias: Timer - Turn off Badkamerfan after 90min.
  trigger:
  - platform: state
    entity_id: switch.badkamerfan_sonoff
    to: 'on'
    for:
      minutes: 90
  action:
  - service: homeassistant.turn_off
    data:
      entity_id:
      - switch.badkamerfan_sonoff
  id: f791ed5369e54ee18de3bf6b46b50d78
- alias: Timer - Turn on Badkamerfan after 7min.
  trigger:
  - platform: state
    entity_id: group.badkamer_spots
    to: 'on'
    for:
      minutes: 7
  action:
  - service: homeassistant.turn_on
    data:
      entity_id:
      - switch.badkamerfan_sonoff
  id: 95fd2766b9554cceb8c790fdbf9d6aa6
- alias: Timer - Turn off Badkamerfan after lights off for 30min.
  trigger:
  - platform: state
    entity_id: group.badkamer_spots
    to: 'off'
    for:
      minutes: 30
  action:
  - service: homeassistant.turn_off
    data:
      entity_id:
      - switch.badkamerfan_sonoff
  id: ab6d346a77044c9581f8ce961b421648
- alias: Timer - Turn on Gangkachel Sonoff after 5sec.
  trigger:
  - platform: state
    entity_id: switch.gangkachel_sonoff
    to: 'off'
    for:
      seconds: 5
  action:
  - service: climate.set_temperature
    data:
      entity_id: climate.gang
      temperature: 7
  - service: homeassistant.turn_off
    data:
      entity_id:
      - input_boolean.gangkachel
  - service: homeassistant.turn_on
    data:
      entity_id:
      - switch.gangkachel_sonoff
  id: f469fa8d0fb34d5589f8e925803746c5
- alias: Timer - Gangkachel schema op werkdagen
  trigger:
    platform: time
    at: 07:00:00
  condition:
    condition: and
    conditions:
    - condition: state
      entity_id: binary_sensor.workday_sensor
      state: 'on'
    - condition: state
      entity_id: input_boolean.homemode_home
      state: 'on'
    - condition: state
      entity_id: input_boolean.gangkachel_schema
      state: 'on'
  action:
  - service: climate.set_temperature
    data:
      entity_id: climate.gang
      temperature: 17
  id: c4a56b363f3f45ac94e40134da528249
- alias: Timer - Gangkachel schema op non-werkdagen
  trigger:
    platform: time
    at: 09:00:00
  condition:
    condition: and
    conditions:
    - condition: state
      entity_id: binary_sensor.workday_sensor
      state: 'off'
    - condition: state
      entity_id: input_boolean.homemode_home
      state: 'on'
    - condition: state
      entity_id: input_boolean.gangkachel_schema
      state: 'on'
  action:
  - service: climate.set_temperature
    data:
      entity_id: climate.gang
      temperature: 17
  id: a1b74b063f9b40a2aeff504708a771d8
- alias: Timer - Gangkachel schema naar Eco op werkdagen
  trigger:
    platform: time
    at: '9:00:00'
  condition:
    condition: and
    conditions:
    - condition: state
      entity_id: binary_sensor.workday_sensor
      state: 'on'
    - condition: state
      entity_id: input_boolean.homemode_home
      state: 'on'
    - condition: state
      entity_id: input_boolean.gangkachel_schema
      state: 'on'
  action:
  - service: climate.set_temperature
    data:
      entity_id: climate.gang
      temperature: 15
  id: 6be6a388d7f748bfa1276fb7242925a6
- alias: Timer - Gangkachel schema naar Eco op non-werkdagen
  trigger:
    platform: time
    at: '11:00:00'
  condition:
    condition: and
    conditions:
    - condition: state
      entity_id: binary_sensor.workday_sensor
      state: 'off'
    - condition: state
      entity_id: input_boolean.homemode_home
      state: 'on'
    - condition: state
      entity_id: input_boolean.gangkachel_schema
      state: 'on'
  action:
  - service: climate.set_temperature
    data:
      entity_id: climate.gang
      temperature: 15
  id: 265725da12cb452b9d901d9a417f396d
- alias: Time - Gangkachel harde reset na 2 uur
  trigger:
  - platform: numeric_state
    entity_id: sensor.gangkachel_huidig_verbruik
    above: 10
    for:
      minutes: 120
  action:
  - service: homeassistant.turn_off
    data:
      entity_id:
      - switch.gangkachel_sonoff
  id: d38ae00b447746318905a9c0fe25aede
- alias: Timer - Keukenkachel uit na 1 uur
  trigger:
  - platform: state
    entity_id: switch.keukenkachel
    to: 'on'
    for:
      minutes: 60
  action:
  - service: homeassistant.turn_off
    data:
      entity_id:
      - switch.keukenkachel
  id: 476762dfb33d4488b4ad29b43615b626
- alias: Timer - Kerstverlichting buiten aan om 17:00
  trigger:
    platform: sun
    event: sunset
    offset: +00:30:00
  action:
  - service: switch.turn_on
    entity_id: switch.kerstverlichting_buiten
  id: 9e7a167f26b64cce96033630501c5de4
- alias: Timer - Kerstverlichting buiten uit om 23:30
  trigger:
    platform: time
    at: '23:30:00'
  action:
  - service: switch.turn_off
    entity_id: switch.kerstverlichting_buiten
  id: 2a974f3029a94c44925cc010d5270db0
- alias: Verwarming uit bij openen raam
  trigger:
  - platform: state
    entity_id: binary_sensor.badkamerraam
    to: 'on'
  - platform: state
    entity_id: binary_sensor.slaapkamer_raam
    to: 'on'
  condition:
  - condition: state
    entity_id: input_boolean.homemode_home
    state: 'on'
  action:
  - service: climate.set_temperature
    data:
      entity_id: climate.thermostaat
      temperature: 16
  - service: climate.set_temperature
    data:
      entity_id: climate.gang
      temperature: 14
  - service: notify.martien
    data:
      message: De verwarming is lager gezet om dat er een raam of deur is geopend.
      title: Verwarming lager
  id: 702fc146c1f248adab33e93f14f1c31c
- alias: Droger - Status naar Aan
  trigger:
  - platform: numeric_state
    entity_id: sensor.droger_huidig_verbruik
    above: 1
  condition:
  - condition: state
    entity_id: input_select.droger_status
    state: Uit
  action:
  - service: input_select.select_option
    data:
      entity_id: input_select.droger_status
      option: Aan
  id: e1f10f2df9f04c04a79ff1a028e96ed1
- alias: Droger - Status naar Uit
  trigger:
  - platform: numeric_state
    entity_id: sensor.droger_huidig_verbruik
    below: 1
  condition:
    condition: or
    conditions:
    - condition: state
      entity_id: input_select.droger_status
      state: Aan
    - condition: state
      entity_id: input_select.droger_status
      state: Klaar
  action:
  - service: input_select.select_option
    data:
      entity_id: input_select.droger_status
      option: Uit
  id: f4cf49be90f146cea4d257cab4c20a12
- alias: Droger - Status naar Drogen
  trigger:
  - platform: numeric_state
    entity_id: sensor.droger_huidig_verbruik
    above: 2000
  condition:
    condition: or
    conditions:
    - condition: state
      entity_id: input_select.droger_status
      state: Aan
    - condition: state
      entity_id: input_select.droger_status
      state: Uit
  action:
  - service: input_select.select_option
    data:
      entity_id: input_select.droger_status
      option: Drogen
  id: f7be4dfbe65447ab97fa6341a96de0d6
- alias: Droger - Status naar Klaar
  trigger:
  - platform: numeric_state
    entity_id: sensor.droger_huidig_verbruik
    below: 100
    for:
      minutes: 5
  condition:
    condition: and
    conditions:
    - condition: state
      entity_id: input_select.droger_status
      state: Drogen
  action:
  - service: input_select.select_option
    data:
      entity_id: input_select.droger_status
      option: Klaar
  - service: notify.notifyall
    data:
      message: De droger is klaar!
      title: Droger Notificatie
  id: ab61d419f0d14c798a56f199fcfec247
- alias: Droger - Status naar Aan na Klaar
  trigger:
  - platform: state
    entity_id: input_select.droger_status
    to: Klaar
    for:
      minutes: 15
  action:
  - service: input_select.select_option
    data:
      entity_id: input_select.droger_status
      option: Aan
  id: 7413841127eb414e9cb6810f2d94ec3e
- alias: Droger - Staat voor niks Aan
  trigger:
  - platform: state
    entity_id: input_select.droger_status
    to: Aan
    for:
      minutes: 15
  action:
  - service: input_select.select_option
    data:
      entity_id: input_select.droger_status
      option: Aan
  - service: notify.notifyall
    data:
      message: De droger staat nog aan!
      title: Droger Notificatie
  id: c55bb75939e044f3a685a2a552b7f761
- alias: Wasmachine - Status naar Opwarmen
  trigger:
  - platform: numeric_state
    entity_id: sensor.wasmachine_huidig_verbruik
    above: 1500
  condition:
  - condition: state
    entity_id: input_select.wasmachine_status
    state: Uit
  action:
  - service: input_select.select_option
    data:
      entity_id: input_select.wasmachine_status
      option: Opwarmen
  id: 42ea3637e2dc4425b525d0ac9c3229bc
- alias: Wasmachine - Status naar Uit
  trigger:
  - platform: numeric_state
    entity_id: sensor.wasmachine_huidig_verbruik
    below: 3
    for:
      minutes: 15
  condition:
  - condition: state
    entity_id: input_select.wasmachine_status
    state: Klaar
  action:
  - service: input_select.select_option
    data:
      entity_id: input_select.wasmachine_status
      option: Uit
  id: 023257d3581546a094b2ca0044e6cf7c
- alias: Wasmachine - Status naar Wassen
  trigger:
  - platform: numeric_state
    entity_id: sensor.wasmachine_huidig_verbruik
    above: 2
    below: 1500
  condition:
    condition: or
    conditions:
    - condition: state
      entity_id: input_select.wasmachine_status
      state: Opwarmen
    - condition: state
      entity_id: input_select.wasmachine_status
      state: Uit
  action:
  - service: input_select.select_option
    data:
      entity_id: input_select.wasmachine_status
      option: Wassen
  id: 78728664a215431d8d9cb9927591d522
- alias: Wasmachine - Status naar Klaar
  trigger:
  - platform: numeric_state
    entity_id: sensor.wasmachine_huidig_verbruik
    below: 3
    for:
      minutes: 5
  condition:
    condition: or
    conditions:
    - condition: state
      entity_id: input_select.wasmachine_status
      state: Wassen
    - condition: state
      entity_id: input_select.wasmachine_status
      state: Opwarmen
  action:
  - service: input_select.select_option
    data:
      entity_id: input_select.wasmachine_status
      option: Klaar
  - service: notify.notifyall
    data:
      message: De wasmachine is klaar!
      title: Wasmachine Notificatie
  id: 8508806d137446eaa4462d451fdf007e
- alias: Gangkachel - Status naar Ventileren
  trigger:
  - platform: numeric_state
    entity_id: sensor.gangkachel_huidig_verbruik
    above: 1
    below: 500
  condition:
    condition: and
    conditions:
    - condition: state
      entity_id: input_select.gangkachel_status
      state: Uit
  action:
  - service: input_select.select_option
    data:
      entity_id: input_select.gangkachel_status
      option: Ventileren
  id: ebaa8b3bdddd4cf58313f68fd96f385b
- alias: Gangkachel - Status naar Afkoelen
  trigger:
  - platform: numeric_state
    entity_id: sensor.gangkachel_huidig_verbruik
    above: 1
    below: 500
  condition:
    condition: or
    conditions:
    - condition: state
      entity_id: input_select.gangkachel_status
      state: Half vermogen
    - condition: state
      entity_id: input_select.gangkachel_status
      state: Vol vermogen
    - condition: and
      conditions:
      - condition: state
        entity_id: input_boolean.gangkachel
        state: 'off'
  action:
  - service: input_select.select_option
    data:
      entity_id: input_select.gangkachel_status
      option: Afkoelen
  id: 47673a5e57ba4fd9acb778f0cda7ec9f
- alias: Gangkachel - Status naar Uit
  trigger:
  - platform: numeric_state
    entity_id: sensor.gangkachel_huidig_verbruik
    below: 1
  action:
  - service: input_select.select_option
    data:
      entity_id: input_select.gangkachel_status
      option: Uit
  id: 438c99d3b8204f9ba743be6e8d179e97
- alias: Gangkachel - Status naar Half vermogen
  trigger:
  - platform: numeric_state
    entity_id: sensor.gangkachel_huidig_verbruik
    below: 1600
    above: 500
  action:
  - service: input_select.select_option
    data:
      entity_id: input_select.gangkachel_status
      option: Half vermogen
  id: 6bf3c52a36fb48ee9779b99217ee46aa
- alias: Gangkachel - Status naar Vol vermogen
  trigger:
  - platform: numeric_state
    entity_id: sensor.gangkachel_huidig_verbruik
    above: 1600
  action:
  - service: input_select.select_option
    data:
      entity_id: input_select.gangkachel_status
      option: Vol vermogen
  id: dd16ae7d883442a698ad2bf3d86dd1ca
- alias: Gangkachel - Ingeschakeld door HA thermostaat
  trigger:
  - platform: state
    entity_id: input_boolean.gangkachel
    to: 'on'
  condition:
  - condition: state
    entity_id: input_select.gangkachel_status
    state: Uit
  action:
  - service: switch.turn_on
    entity_id: switch.gangkachel_aanuit
  id: 7f71e7b124c840bea7cd174849c1faff
- alias: Gangkachel - Instellen bij Ventileren
  trigger:
  - platform: state
    entity_id: input_boolean.gangkachel
    to: 'on'
    for:
      seconds: 15
  condition:
  - condition: state
    entity_id: input_select.gangkachel_status
    state: Ventileren
  action:
  - service: switch.turn_on
    entity_id: switch.gangkachel_highlow
  id: 0cc675f56ebc4e2fa6a5a70b96de265f
- alias: Gangkachel - Instellen bij Half vermogen
  trigger:
  - platform: state
    entity_id: input_boolean.gangkachel
    to: 'on'
    for:
      seconds: 30
  condition:
  - condition: state
    entity_id: input_select.gangkachel_status
    state: Half vermogen
  action:
  - service: switch.turn_on
    entity_id: switch.gangkachel_highlow
  id: f7e574f224e04047aebb113ddbd3d9de
- alias: Gangkachel - Instellen bij Afkoelen
  trigger:
  - platform: state
    entity_id: input_boolean.gangkachel
    to: 'on'
    for:
      seconds: 15
  condition:
  - condition: state
    entity_id: input_select.gangkachel_status
    state: Afkoelen
  action:
  - service: switch.turn_on
    entity_id: switch.gangkachel_aanuit
  id: d8e6913bfc8f42918c78e95bfb723795
- alias: Gangkachel - Thermostaat Uitgeschakeld bij status Vermogen
  trigger:
  - platform: state
    entity_id: input_boolean.gangkachel
    to: 'off'
  condition:
    condition: or
    conditions:
    - condition: state
      entity_id: input_select.gangkachel_status
      state: Half vermogen
    - condition: state
      entity_id: input_select.gangkachel_status
      state: Vol vermogen
  action:
  - service: switch.turn_off
    entity_id: switch.gangkachel_aanuit
  id: 2aacff0503a848eb8543edc4b3ee862b
- alias: Gangkachel - Terug naar Half vermogen na 15min.
  trigger:
  - platform: state
    entity_id: input_select.gangkachel_status
    to: Vol vermogen
    for:
      minutes: 15
  action:
  - service: switch.turn_on
    entity_id: switch.gangkachel_highlow
  - delay: 00:00:05
  - service: switch.turn_on
    entity_id: switch.gangkachel_highlow
  id: f5ada450f3784dad88a64f16ee2dd72a
- alias: Doorbell - Pause Apple TV on Doorbell
  trigger:
  - platform: event
    event_type: button_pressed
    event_data:
      entity_id: switch.deurbel
  - platform: event
    event_type: doorbird_looppoort_deurbel_button
  condition:
  - condition: state
    entity_id: media_player.woonkamer_apple_tv
    state: playing
  action:
  - service: media_player.media_pause
    entity_id: media_player.woonkamer_apple_tv
  id: 5c7af48f898e4b9e8d377fb9cb898e72
- alias: Doorbell - Play doorbell chime via Sonos
  trigger:
  - platform: event
    event_type: button_pressed
    event_data:
      entity_id: switch.deurbel
  - platform: event
    event_type: doorbird_looppoort_deurbel_button
  condition:
    condition: state
    entity_id: group.personen
    state: home
  action:
  - service: media_player.volume_set
    entity_id:
    - media_player.google_home_mini
    data:
      volume_level: 0.6
  - service: media_player.play_media
    data_template:
      entity_id:
      - media_player.google_home_mini
      media_content_id: https://martiendekleijn.duckdns.org:8123/local/doorbell.mp3
      media_content_type: music
  - delay: 00:00:13
  - service: tts.google_say
    entity_id: media_player.google_home_mini
    data:
      message: Er heeft iemand op de bel gedrukt.
  - delay: 00:00:08
  - service: media_player.volume_set
    entity_id:
    - media_player.google_home_mini
    data:
      volume_level: 0.4
  id: 0e209584f8db43be8ffb0157148b916b
- alias: Motion - Ganglight aan bij Beweging
  trigger:
  - platform: state
    entity_id: binary_sensor.gang_motion
    to: 'on'
  condition:
    condition: and
    conditions:
    - condition: state
      entity_id: input_boolean.homemode_home
      state: 'on'
    - condition: sun
      after: sunset
  action:
  - service: switch.turn_on
    entity_id: switch.ganglicht
  id: 0e634010193a4d56b1db22092ae70d0c
- alias: Motion - Ganglight uit bij geen beweging
  trigger:
  - platform: state
    entity_id: binary_sensor.gang_motion
    to: 'off'
    for:
      minutes: 10
  action:
  - service: switch.turn_off
    entity_id:
    - switch.ganglicht
  id: 2464ece0ee364fd0a6238db652a53d03
- alias: Motion - Keukenlicht naar normaal bij beweging
  trigger:
  - platform: state
    entity_id: binary_sensor.keuken_motion
    to: 'on'
  - platform: state
    entity_id: binary_sensor.keukendeur
    to: 'on'
  condition:
    condition: and
    conditions:
    - condition: state
      entity_id: input_boolean.homemode_home
      state: 'on'
    - condition: sun
      after: sunset
    - condition: time
      after: '20:00:00'
    - condition: state
      entity_id: light.keuken_5
      state: 'on'
    - condition: state
      entity_id: light.keuken_4
      state: 'on'
    - condition: state
      entity_id: light.keuken_3
      state: 'off'
    - condition: state
      entity_id: light.keuken_2
      state: 'off'
    - condition: state
      entity_id: light.keuken_1
      state: 'off'
  action:
  - service: hue.hue_activate_scene
    data:
      group_name: Keuken
      scene_name: Normaal
  id: a670efc209124614952e92e9155cb96f
- alias: Motion - Keukenlicht naar sfeer bij geen beweging
  trigger:
  - platform: state
    entity_id: binary_sensor.keuken_motion
    to: 'off'
    for:
      minutes: 10
  condition:
    condition: and
    conditions:
    - condition: state
      entity_id: input_boolean.homemode_home
      state: 'on'
    - condition: sun
      after: sunset
    - condition: time
      after: '20:00:00'
    - condition: state
      entity_id: light.keuken_5
      state: 'on'
    - condition: state
      entity_id: light.keuken_4
      state: 'on'
    - condition: state
      entity_id: light.keuken_3
      state: 'on'
    - condition: state
      entity_id: light.keuken_2
      state: 'on'
    - condition: state
      entity_id: light.keuken_1
      state: 'on'
  action:
  - service: hue.hue_activate_scene
    data:
      group_name: Keuken
      scene_name: Sfeerverlichting
  id: 58dd39a5a73d4d5b8c9ccd1a490db2e7
- alias: Pushbutton - Keuken Hekopener
  trigger:
  - platform: state
    entity_id: binary_sensor.keuken_hekopener
    to: 'on'
  - platform: state
    entity_id: binary_sensor.woonkamer_hekopener
    to: 'on'
  action:
  - service: switch.turn_on
    entity_id:
    - switch.looppoort_deurbel_relay_1
  - service: tts.google_say
    entity_id: media_player.google_home_mini
    data:
      message: Hek wordt geopend
  id: 8068506ce5f1406aa11be088becc9bbd
- alias: Pushbutton - Nachtkastjes - Bedtijd
  trigger:
  - platform: state
    entity_id: binary_sensor.nachtkastje_martien
    to: 'on'
  - platform: state
    entity_id: binary_sensor.nachtkastje_deborah
    to: 'on'
  condition:
    condition: and
    conditions:
    - condition: state
      entity_id: input_boolean.homemode_bedtime
      state: 'off'
    - condition: state
      entity_id: input_boolean.homemode_night
      state: 'off'
  action:
  - service: input_boolean.turn_on
    entity_id:
    - input_boolean.homemode_bedtime
  id: 35b425c0ed1b46209d1bd3be64867b41
- alias: Pushbutton - Nachtkastjes - Nachtmode
  trigger:
  - platform: state
    entity_id: binary_sensor.nachtkastje_martien
    to: 'on'
  - platform: state
    entity_id: binary_sensor.nachtkastje_deborah
    to: 'on'
  condition:
    condition: and
    conditions:
    - condition: state
      entity_id: input_boolean.homemode_bedtime
      state: 'on'
    - condition: state
      entity_id: input_boolean.homemode_night
      state: 'off'
  action:
  - service: input_boolean.turn_on
    entity_id:
    - input_boolean.homemode_night
  id: caa9b03ccf06446e9189594b408d6b7a
- alias: Pushbutton - Nachtkastjes - Nachtlampje Aan
  trigger:
  - platform: state
    entity_id: binary_sensor.nachtkastje_martien
    to: 'on'
  - platform: state
    entity_id: binary_sensor.nachtkastje_deborah
    to: 'on'
  condition:
    condition: and
    conditions:
    - condition: state
      entity_id: input_boolean.homemode_bedtime
      state: 'off'
    - condition: state
      entity_id: input_boolean.homemode_night
      state: 'on'
    - condition: state
      entity_id: group.slaapkamer_spots
      state: 'off'
  action:
  - service: hue.hue_activate_scene
    data:
      group_name: Slaapkamer
      scene_name: Nachtlampje
  id: 3b98af60eeae4f5eb2f0ce8d133df49c
- alias: Pushbutton - Nachtkastjes - Nachtlampje Uit
  trigger:
  - platform: state
    entity_id: binary_sensor.nachtkastje_martien
    to: 'on'
  - platform: state
    entity_id: binary_sensor.nachtkastje_deborah
    to: 'on'
  condition:
    condition: and
    conditions:
    - condition: state
      entity_id: input_boolean.homemode_bedtime
      state: 'off'
    - condition: state
      entity_id: input_boolean.homemode_night
      state: 'on'
    - condition: state
      entity_id: group.slaapkamer_spots
      state: 'on'
  action:
  - service: homeassistant.turn_off
    entity_id: group.slaapkamer_spots
  id: 2c607b13585f4ccca26bda4ef39bf57e
- alias: Notification - Doorbell pressed
  trigger:
  - platform: event
    event_type: button_pressed
    event_data:
      entity_id: switch.deurbel
  - platform: event
    event_type: doorbird_looppoort_deurbel_button
  action:
  - service: notify.notifyall
    data:
      message: De deurbel gaat!
      title: Ding! Dong!
      data:
        push:
          category: camera
        entity_id: camera.looppoort_deurbel_live
  id: 9ab6ebb8dbe24decb1be2d3ab89a59ca
- alias: Notification - Landroid Alarm
  trigger:
  - platform: numeric_state
    entity_id: landroid.no_of_alarms
    above: 0
  action:
  - service: notify.pushover
    data_template:
      message: 'Warning: The lawnmower is reporting an error.'
      title: Lawnmower Error
  - service: notify.notifyme
    data:
      message: Today at {{(now().strftime('%s') | int | timestamp_custom('%H:%M'))}}
        the lawnmower had reported an error.
  id: d9d5f21b88da46ac87b378ee7ed0b880
- alias: Notification - Home Assistant Startup
  trigger:
  - platform: homeassistant
    event: start
  action:
  - service: notify.martien
    data:
      message: Home Assistant is sinds {{(now().strftime('%s') | int | timestamp_custom('%H:%M'))}}
        weer online.
      title: HA Online
  id: 028dafedef19459c8b91f7320d96e7ea
- alias: Notification - Home Assistant Shutdown
  trigger:
  - platform: homeassistant
    event: shutdown
  action:
  - service: notify.martien
    data:
      message: 'Waarschuwing: Home Assistant wordt herstart.'
      title: HA Herstart
  id: 9201356dbd2f4940b6852a5ac485ce41
- alias: IFTTT Webhook verzoeken
  trigger:
    platform: event
    event_type: ifttt_webhook_received
    event_data:
      action: call_service
  action:
    service_template: '{{ trigger.event.data.service }}'
    data_template:
      entity_id: '{{ trigger.event.data.entity_id }}'
  id: 56e179bb52214872824c21294d3c34df
- id: '1591346508660'
  alias: Overloop Tap Turn on Bedtijd
  description: ''
  trigger:
  - device_id: 7e33f8fecd5945e590020970559a6e57
    domain: hue
    platform: device
    subtype: button_4
    type: remote_button_short_press
  condition:
  - after: '22:00'
    before: '2:00'
    condition: time
  action:
  - scene: scene.teset
